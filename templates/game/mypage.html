{% extends 'game/base.html' %}
{% load number_filters %}

{% block title %}ë§ˆì´í˜ì´ì§€ - ìœ ë‹ˆì½˜ ë©”ì´ì»¤{% endblock %}

{% block content %}
<div class="mypage">
    
    <!-- í”„ë¡œí•„ ì„¹ì…˜ -->
    <section class="profile-section">
        <div class="profile-image">
            {% if user.img_profile %}
                <img src="{{ user.img_profile.url }}" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
            {% else %}
                <div class="default-avatar">ğŸ‘¤</div>
            {% endif %}
        </div>
        
        <div class="profile-info">
            <h1>{{ user.nickname }}</h1>
            <p class="username">@{{ user.username }}</p>
        </div>
    </section>

    <!-- í†µê³„ ì„¹ì…˜ -->
    <section class="stats-section">
        <div class="stat-item">
            <span class="stat-value" style="color: #55efc4;">{{ user.best_profit_rate|floatformat:1 }}%</span>
            <span class="stat-label">ìµœê³  ìˆ˜ìµë¥ </span>
        </div>
        <div class="stat-item">
            <span class="stat-value">{{ user.total_games }}</span>
            <span class="stat-label">ì´ í”Œë ˆì´</span>
        </div>
    </section>

    <!-- ìµœê·¼ ê²Œì„ ê¸°ë¡ -->
    <section class="recent-games">
        <h2>ğŸ“‹ ìµœê·¼ ê²Œì„ ê¸°ë¡</h2>
        
        {% if recent_games %}
        <table class="games-table">
            <thead>
                <tr>
                    <th>ë‚ ì§œ</th>
                    <th>ìˆ˜ìµë¥ </th>
                    <th>ìµœì¢… ìë³¸</th>
                </tr>
            </thead>
            <tbody>
                {% for game in recent_games %}
                <tr>
                    <td>{{ game.created_at|date:"m/d H:i" }}</td>
                    <td class="{% if game.final_profit_rate >= 0 %}positive{% else %}negative{% endif %}">
                        {{ game.final_profit_rate|floatformat:1 }}%
                    </td>
                    <td>{{ game.current_capital|korean_currency }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="empty-message">ì•„ì§ ê²Œì„ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </section>

    <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„¹ì…˜ (ë™ì£¼ ë‹´ë‹¹) 
    {% comment "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê¸°ëŠ¥ - ë‚˜ì¤‘ì— êµ¬í˜„" %}
    <section class="password-section glass-card">
        <h2>ğŸ” ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h2>
        
        <form method="POST" action="{% url 'game:change_password' %}">
            {% csrf_token %}
            
            <div class="form-group">
                <label>í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" name="old_password" required>
            </div>
            
            <div class="form-group">
                <label>ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" name="new_password1" required>
            </div>
            
            <div class="form-group">
                <label>ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input type="password" name="new_password2" required>
            </div>
            
            <button type="submit" class="btn btn-primary">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
        </form>
    </section>
    {% endcomment %}
    -->

    <div class="btn-group">
        <a href="{% url 'game:game_start' %}" class="btn btn-primary">ğŸš€ ê²Œì„ ì‹œì‘</a>
        <a href="{% url 'game:main' %}" class="btn btn-secondary">ğŸ  ë©”ì¸ìœ¼ë¡œ</a>
    </div>
</div>
{% endblock %}
